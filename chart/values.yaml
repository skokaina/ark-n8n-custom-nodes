app:
  name: ark-n8n
  image:
    repository: ghcr.io/skokaina/ark-n8n
    pullPolicy: IfNotPresent
    tag: latest

  port: 5678

  env:
    N8N_HOST: ark-n8n.default.127.0.0.1.nip.io
    N8N_PORT: "5678"
    N8N_PROTOCOL: http
    N8N_SECURE_COOKIE: "false"
    N8N_PROXY_HOPS: "1"
    N8N_EDITOR_BASE_URL: http://ark-n8n.default.127.0.0.1.nip.io
    WEBHOOK_URL: http://ark-n8n.default.127.0.0.1.nip.io
    N8N_PUSH_BACKEND: websocket
    GENERIC_TIMEZONE: America/New_York
    N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS: "true"
    N8N_RUNNERS_ENABLED: "true"
    EXECUTIONS_MODE: regular
    EXECUTIONS_DATA_SAVE_ON_SUCCESS: "all"
    EXECUTIONS_DATA_SAVE_ON_ERROR: "all"

    # Authentication settings
    # For production: keep N8N_BASIC_AUTH_ACTIVE=true and set credentials
    # For testing/demos: set N8N_BASIC_AUTH_ACTIVE=false to disable login
    N8N_BASIC_AUTH_ACTIVE: "true"
    # N8N_BASIC_AUTH_USER: "admin"
    # N8N_BASIC_AUTH_PASSWORD: "changeme"

ark:
  apiUrl: http://ark-api.default.svc.cluster.local:80
  # Supported ARK API version range. Set to "" to skip the version check.
  supportedVersions: ">=0.1.50 <0.1.60"

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

mcp:
  enabled: false  # MCP image not published yet - enable manually if building locally
  image:
    repository: ghcr.io/skokaina/ark-n8n-mcp
    pullPolicy: IfNotPresent
    tag: latest
  port: 8080
  # n8n connection settings
  n8nUrl: "http://localhost:5678"  # Base URL for n8n webhooks (configurable per environment)
  env:
    PORT: "8080"
    TOOLS_SHARED_PATH: /tmp/tools
    # N8N_INTERNAL_URL is set from mcp.n8nUrl in deployment template
    # N8N_API_KEY is set from n8nApiKey secret if configured
  resources:
    limits:
      cpu: 200m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi

# n8n API authentication (REQUIRED)
# n8n always requires API key for endpoint authentication
# For production: Create secret manually and reference with existingSecret
# For testing: Can use create=true with --set (not recommended for production)
n8nApiKey:
  # Create secret from Helm values (NOT recommended for production)
  create: false
  value: ""  # Set via --set n8nApiKey.value="your-key" for testing only

  # Use existing secret (RECOMMENDED for production)
  # kubectl create secret generic n8n-api-key --from-literal=api-key="your-key"
  existingSecret: ""  # Name of existing secret containing 'api-key' key

  # Secret name to use if create=true
  secretName: "n8n-api-key"

storage:
  enabled: true
  size: 1Gi
  storageClass: ""
  accessMode: ReadWriteOnce
  mountPath: /home/node/.n8n

httpRoute:
  enabled: true
  gateway:
    name: localhost-gateway
    namespace: ark-system
  hostnames:
    - ark-n8n.default.127.0.0.1.nip.io
  # Origin header for CORS - defaults to protocol://first-hostname if not set
  origin: "ark-n8n.default.127.0.0.1.nip.io"
  rules:
    - backendRefs:
        - name: ark-n8n
          port: 5678

service:
  type: ClusterIP
  port: 5678
  targetPort: 5678
